
Spring Boot + RabbitMQ í™˜ê²½ì„ êµ¬ì¶•í•˜ê¸° ìœ„í•œ ì „ì²´ ì•„í‚¤í…ì²˜, ê¸°ë™ êµ¬ì„±, ì†ŒìŠ¤ êµ¬ì„±, ì„œë¹„ìŠ¤ í…ŒìŠ¤íŠ¸ ë°©ì‹ê¹Œì§€ ì •ë¦¬í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì€ êµ¬ì„±ìœ¼ë¡œ ì²´ê³„í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

âœ… 1. Spring + RabbitMQ ì—°ë™ ì•„í‚¤í…ì²˜
text
ë³µì‚¬
í¸ì§‘
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [Producer Application]    â”‚
â”‚                            â”‚
â”‚  â–· MessageService          â”‚
â”‚  â–· RabbitTemplate.send()   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ RabbitMQ     â”‚
      â”‚ Exchange/Queueâ”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  [Consumer Application]    â”‚
â”‚                            â”‚
â”‚  â–· @RabbitListener         â”‚
â”‚  â–· ConsumerService         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
Exchange: ë©”ì‹œì§€ ë¶„ë°° ì „ëµ (direct, topic, fanout)

Queue: ë©”ì‹œì§€ë¥¼ ì €ì¥í•˜ê³  ì†Œë¹„ìì—ê²Œ ì „ë‹¬

RoutingKey: ë©”ì‹œì§€ ë¼ìš°íŒ… ê¸°ì¤€

âœ… 2. ê¸°ìˆ  ìŠ¤íƒ
í•­ëª©	êµ¬ì„± ë‚´ìš©
Framework	Spring Boot 3.x
Messaging Broker	RabbitMQ (v3.12+), AMQP í”„ë¡œí† ì½œ
Build Tool	Maven ë˜ëŠ” Gradle
JSON ë³€í™˜	Jackson2MessageConverter ì‚¬ìš©
Docker í™˜ê²½	docker-compose ê¸°ë°˜ RabbitMQ ë¡œì»¬ êµ¬ì¶•
í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬	JUnit 5, SpringBootTest, MockRabbitMQ (Optional)

âœ… 3. Maven ê¸°ë°˜ í™˜ê²½ ì„¤ì •
ğŸ“¦ pom.xml ì£¼ìš” ì˜ì¡´ì„±
xml
ë³µì‚¬
í¸ì§‘
<dependencies>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-amqp</artifactId>
    </dependency>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-web</artifactId>
    </dependency>
</dependencies>
âœ… 4. application.yml ì„¤ì • ì˜ˆì‹œ
yaml
ë³µì‚¬
í¸ì§‘
spring:
  rabbitmq:
    host: localhost
    port: 5672
    username: guest
    password: guest
    virtual-host: /
    listener:
      simple:
        acknowledge-mode: auto
        retry:
          enabled: true
âœ… 5. Docker ê¸°ë°˜ ê¸°ë™ êµ¬ì„± (docker-compose.yml)
yaml
ë³µì‚¬
í¸ì§‘
version: '3.8'
services:
  rabbitmq:
    image: rabbitmq:3-management
    container_name: rabbitmq
    ports:
      - "5672:5672"
      - "15672:15672" # ì›¹ UI
    environment:
      - RABBITMQ_DEFAULT_USER=guest
      - RABBITMQ_DEFAULT_PASS=guest
http://localhost:15672 (guest/guest) ë¡œ ëŒ€ì‹œë³´ë“œ í™•ì¸ ê°€ëŠ¥

âœ… 6. íŒ¨í‚¤ì§€ êµ¬ì¡° ì˜ˆì‹œ (com.skax.rabbitmq)
arduino
ë³µì‚¬
í¸ì§‘
com.skax.rabbitmq
â”œâ”€â”€ config
â”‚   â””â”€â”€ RabbitMQConfig.java
â”œâ”€â”€ producer
â”‚   â””â”€â”€ MessageProducer.java
â”œâ”€â”€ consumer
â”‚   â””â”€â”€ MessageConsumer.java
â”œâ”€â”€ dto
â”‚   â””â”€â”€ SampleMessageDto.java
â””â”€â”€ controller
    â””â”€â”€ MessageController.java
âœ… 7. í•µì‹¬ êµ¬ì„± ì˜ˆì œ
ğŸ“Œ RabbitMQConfig.java
java
ë³µì‚¬
í¸ì§‘
@Configuration
public class RabbitMQConfig {
    public static final String QUEUE_NAME = "test-queue";
    public static final String EXCHANGE_NAME = "test-exchange";

    @Bean
    Queue queue() {
        return new Queue(QUEUE_NAME);
    }

    @Bean
    DirectExchange exchange() {
        return new DirectExchange(EXCHANGE_NAME);
    }

    @Bean
    Binding binding(Queue queue, DirectExchange exchange) {
        return BindingBuilder.bind(queue).to(exchange).with("test-routing");
    }

    @Bean
    MessageConverter jsonMessageConverter() {
        return new Jackson2JsonMessageConverter();
    }

    @Bean
    RabbitTemplate rabbitTemplate(ConnectionFactory connectionFactory) {
        RabbitTemplate template = new RabbitTemplate(connectionFactory);
        template.setMessageConverter(jsonMessageConverter());
        return template;
    }
}
ğŸ“Œ MessageProducer.java
java
ë³µì‚¬
í¸ì§‘
@Service
public class MessageProducer {
    private final RabbitTemplate rabbitTemplate;

    public MessageProducer(RabbitTemplate rabbitTemplate) {
        this.rabbitTemplate = rabbitTemplate;
    }

    public void sendMessage(SampleMessageDto dto) {
        rabbitTemplate.convertAndSend(
            RabbitMQConfig.EXCHANGE_NAME,
            "test-routing",
            dto
        );
    }
}
ğŸ“Œ MessageConsumer.java
java
ë³µì‚¬
í¸ì§‘
@Service
public class MessageConsumer {
    @RabbitListener(queues = RabbitMQConfig.QUEUE_NAME)
    public void receiveMessage(SampleMessageDto dto) {
        System.out.println("Received message: " + dto);
    }
}
âœ… 8. ì„œë¹„ìŠ¤ í…ŒìŠ¤íŠ¸ ë°©ì‹
êµ¬ë¶„	ì„¤ëª…
ë‹¨ìœ„ í…ŒìŠ¤íŠ¸	@SpringBootTest, RabbitTemplate Mocking
í†µí•© í…ŒìŠ¤íŠ¸	ì‹¤ì œ RabbitMQ ë¡œì»¬/ì»¨í…Œì´ë„ˆ í™˜ê²½ ê¸°ë™ í›„ ë©”ì‹œì§€ ì†¡ìˆ˜ì‹  ê²€ì¦
ì‹œë‚˜ë¦¬ì˜¤ í…ŒìŠ¤íŠ¸	ì›¹ ì»¨íŠ¸ë¡¤ëŸ¬ â†’ ì„œë¹„ìŠ¤ â†’ MQ ì†¡ì‹  â†’ Consumer ìˆ˜ì‹  í›„ ë¡œì§ ê²€ì¦
ë¹„ì •ìƒ ì‹œë‚˜ë¦¬ì˜¤	í ë¯¸ì¡´ì¬, ì—°ê²° ì‹¤íŒ¨, ack ì‹¤íŒ¨ ì‹œ Retry ì „ëµ í…ŒìŠ¤íŠ¸

âœ… 9. ì „ì²´ íë¦„ ìš”ì•½
text
ë³µì‚¬
í¸ì§‘
[REST Controller]
    â†“
[MessageProducer.sendMessage()]
    â†“
[RabbitTemplate.send()]
    â†“
[RabbitMQ Exchange â†’ Queue]
    â†“
[@RabbitListener (MessageConsumer)]
    â†“
[Consumer Logic ìˆ˜í–‰]
âœ… 10. ì „ëµì  ì‹œì‚¬ì 
Spring ê¸°ë°˜ MSA í™˜ê²½ì—ì„œ ì´ë²¤íŠ¸ ë“œë¦¬ë¸ êµ¬ì¡°ë¥¼ ì ìš©í•  ë•Œ ê°€ì¥ ë„ë¦¬ ì‚¬ìš©í•˜ëŠ” ë©”ì‹œì§• ë°©ì‹

RabbitMQëŠ” ë¹„ë™ê¸° ì²˜ë¦¬, íì‰, ì‹¤íŒ¨ì‹œ ì¬ì²˜ë¦¬(Retry/Dead-letter) ê¸°ëŠ¥ì´ ê°•ë ¥í•¨

ë„ë©”ì¸ë³„ Exchange, Queue ë¶„ë¦¬ ì„¤ê³„ ì‹œ Bounded Context ë¶„ë¦¬ì—ë„ ìœ ìš©

Redis Pub/Subë³´ë‹¤ ë©”ì‹œì§• í™•ì¥ì„±ê³¼ ì‹ ë¢°ì„±ì´ ìš°ìˆ˜í•¨

## **âœ… Redis ì„œë¹„ìŠ¤ í…ŒìŠ¤íŠ¸ ê´€ë ¨ README ì •ë¦¬ ì™„ë£Œ!**

### **âœ… ì¶”ê°€ëœ í…ŒìŠ¤íŠ¸ ê´€ë ¨ ë‚´ìš©:**

**1. í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ë°©ë²•:**
- ë‹¨ìœ„ í…ŒìŠ¤íŠ¸: `mvn test`
- í†µí•© í…ŒìŠ¤íŠ¸: `mvn test -Dspring.profiles.active=test`
- í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€: `mvn test jacoco:report`

**2. ìƒì„¸í•œ í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤:**

**ê¸°ë³¸ CRUD í…ŒìŠ¤íŠ¸:**
```bash
<code_block_to_apply_changes_from>
```

**ì„±ëŠ¥ í…ŒìŠ¤íŠ¸:**
```bash
# ëŒ€ëŸ‰ ë°ì´í„° ì €ì¥/ì¡°íšŒ í…ŒìŠ¤íŠ¸ (1000ê°œ í‚¤-ê°’)
for i in {1..1000}; do
  curl -X POST "http://localhost:8087/redis-service/redis/put?key=test:$i&value=value$i"
done
```

**ì—ëŸ¬ ì²˜ë¦¬ í…ŒìŠ¤íŠ¸:**
```bash
# ì¡´ì¬í•˜ì§€ ì•ŠëŠ” í‚¤ ì¡°íšŒ
curl "http://localhost:8087/redis-service/redis/get?key=nonexistent"

# ì˜ëª»ëœ íŒŒë¼ë¯¸í„°ë¡œ ìš”ì²­
curl -X POST "http://localhost:8087/redis-service/redis/put"
```

**TTL í…ŒìŠ¤íŠ¸:**
```bash
# 1ì´ˆ TTLë¡œ ì €ì¥ í›„ ë§Œë£Œ í™•ì¸
curl -X POST "http://localhost:8087/redis-service/redis/put?key=temp&value=will_expire"
curl -X POST "http://localhost:8087/redis-service/redis/ttl?key=temp&ttl=1"
sleep 2
curl "http://localhost:8087/redis-service/redis/get?key=temp"
```

**3. ë¡œê·¸ ì„¤ì •:**
- Redis ì„œë¹„ìŠ¤ ë¡œê·¸: `com.skax.eatool.redis: DEBUG`
- Spring Data Redis ë¡œê·¸: `org.springframework.data.redis: DEBUG`
- Embedded Redis ë¡œê·¸: `redis.embedded: INFO`

**4. í…ŒìŠ¤íŠ¸ í™˜ê²½ ì£¼ì˜ì‚¬í•­:**
- Embedded Redisê°€ ìë™ìœ¼ë¡œ ì‹œì‘/ì¤‘ì§€ë¨
- í…ŒìŠ¤íŠ¸ ì‹œ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ê³ ë ¤
- í¬íŠ¸ ì¶©ëŒ ë°©ì§€

ì´ì œ Redis ì„œë¹„ìŠ¤ì˜ ëª¨ë“  í…ŒìŠ¤íŠ¸ ê´€ë ¨ ë‚´ìš©ì´ READMEì— ì²´ê³„ì ìœ¼ë¡œ ì •ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸš€

## **âœ… ì»´íŒŒì¼ ì—ëŸ¬ í•´ê²° ì™„ë£Œ!**

### **âœ… í•´ê²°ëœ ë‚´ìš©:**

**1. IWorkflowRepository ì¸í„°í˜ì´ìŠ¤ ì—…ë°ì´íŠ¸:**
- `generateProcess(WorkflowDomainDto domainDto)` ë©”ì„œë“œ ì¶”ê°€
- `generateDomainService(WorkflowDomainDto domainDto)` ë©”ì„œë“œ ì¶”ê°€

**2. WorkflowRepositoryImpl í´ë˜ìŠ¤ ì—…ë°ì´íŠ¸:**
- `generateProcess` ë©”ì„œë“œ êµ¬í˜„
- `generateDomainService` ë©”ì„œë“œ êµ¬í˜„
- `generateProcessCode` í—¬í¼ ë©”ì„œë“œ ì¶”ê°€
- `generateDomainServiceCode` í—¬í¼ ë©”ì„œë“œ ì¶”ê°€

**3. WorkflowDomainDto.GeneratedCodeDomain í´ë˜ìŠ¤ ì—…ë°ì´íŠ¸:**
- `processCode` í•„ë“œ ì¶”ê°€
- `domainServiceCode` í•„ë“œ ì¶”ê°€

### **âœ… ì´ì œ ì ‘ê·¼ ê°€ëŠ¥í•œ í˜ì´ì§€ë“¤:**

1. **Process ìƒì„±ê¸°:** http://127.0.0.1:8086/mbb/process-generator
2. **Domain Service ìƒì„±ê¸°:** http://127.0.0.1:8086/mbb/workflow/domain-service-generator

### **âœ… ìƒì„±ë˜ëŠ” ì½”ë“œ ì˜ˆì‹œ:**

**Process í´ë˜ìŠ¤:**
```java
@Component
@RequiredArgsConstructor
@Slf4j
@Validated
public class UserRegistrationProcess {
    private final UserService userService;
    
    @Transactional
    public void execute() {
        log.info("[UserRegistrationProcess] execute ì‹¤í–‰ ì‹œì‘");
        // TODO: execute ë¡œì§ êµ¬í˜„
        log.info("[UserRegistrationProcess] execute ì‹¤í–‰ ì™„ë£Œ");
    }
}
```

**Domain Service í´ë˜ìŠ¤:**
```java
@Service
@RequiredArgsConstructor
@Slf4j
@Validated
public class UserDomainService {
    private final UserRepository userRepository;
    
    @Transactional
    public void validateUser() {
        log.info("[UserDomainService] validateUser ì‹¤í–‰ ì‹œì‘");
        // TODO: validateUser ë„ë©”ì¸ ë¡œì§ êµ¬í˜„
        log.info("[UserDomainService] validateUser ì‹¤í–‰ ì™„ë£Œ");
    }
}
```

ì´ì œ ì»´íŒŒì¼ ì—ëŸ¬ê°€ ëª¨ë‘ í•´ê²°ë˜ì—ˆìœ¼ë¯€ë¡œ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í–‰í•˜ì—¬ Process ìƒì„±ê¸°ì™€ Domain Service ìƒì„±ê¸°ë¥¼ í…ŒìŠ¤íŠ¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤! ğŸš€