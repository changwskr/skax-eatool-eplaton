# Backend Business Logic Guide

## ğŸ¢ **SKAX EA Tool Eplaton Business Logic Implementation Rules**

### **ğŸ—ï¸ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì•„í‚¤í…ì²˜ ê°œìš”**

```
ğŸ“¦ Business Logic Layer Structure
â”œâ”€â”€ ğŸ¯ AS (Application Service) Layer
â”‚   â”œâ”€â”€ Business Logic Orchestration
â”‚   â”œâ”€â”€ Transaction Management
â”‚   â”œâ”€â”€ Service Coordination
â”‚   â””â”€â”€ Data Validation
â”œâ”€â”€ ğŸ”§ PC (Presentation Control) Layer
â”‚   â”œâ”€â”€ Data Transformation
â”‚   â”œâ”€â”€ Business Rules
â”‚   â””â”€â”€ Domain Logic
â”œâ”€â”€ ğŸ’¾ DC (Data Control) Layer
â”‚   â”œâ”€â”€ Data Access Logic
â”‚   â”œâ”€â”€ Repository Operations
â”‚   â””â”€â”€ Database Transactions
â””â”€â”€ ğŸ­ EPlaton Framework
    â”œâ”€â”€ TCF (Transaction Control Framework)
    â”œâ”€â”€ BizAction (Business Action)
    â””â”€â”€ BizDelegate (Business Delegate)
```

### **ğŸ¯ MUST FOLLOW - ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ êµ¬í˜„ ê·œì¹™**

#### **1. Application Service (AS) í´ë˜ìŠ¤ êµ¬ì¡°**

**âœ… ì˜¬ë°”ë¥¸ AS í´ë˜ìŠ¤ êµ¬ì¡°**
```java
/**
 * {ë„ë©”ì¸} ê´€ë¦¬ Application Service
 * 
 * í”„ë¡œê·¸ë¨ëª…: AS{ëª¨ë“ˆ}{ê¸°ëŠ¥ë²ˆí˜¸}.java
 * ì„¤ëª…: {ë„ë©”ì¸} ê´€ë¦¬ ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë¹„ìŠ¤
 * ì‘ì„±ì¼: 2024-01-01
 * ì‘ì„±ì: SKAX Project Team
 * 
 * ì£¼ìš” ê¸°ëŠ¥:
 * - {ë„ë©”ì¸} CRUD ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
 * - ACì™€ PC ê°„ì˜ ë°ì´í„° ì „ë‹¬
 * - íŠ¸ëœì­ì…˜ ê´€ë¦¬
 * - ì—ëŸ¬ ì²˜ë¦¬ ë° ë¡œê¹…
 * 
 * @version 1.0
 */
@Service
@Transactional
public class AS{ëª¨ë“ˆ}{ê¸°ëŠ¥ë²ˆí˜¸} implements NewIApplicationService {
    
    private static final NewIKesaLogger logger = NewKesaLogHelper.getBiz();
    
    @Autowired
    private PC{ë„ë©”ì¸} pc{ë„ë©”ì¸};
    
    @Autowired
    private DC{ë„ë©”ì¸} dc{ë„ë©”ì¸};
    
    /**
     * ì• í”Œë¦¬ì¼€ì´ì…˜ ì„œë¹„ìŠ¤ ì‹¤í–‰
     * 
     * @param reqData ìš”ì²­ ë°ì´í„°
     * @return ì‘ë‹µ ë°ì´í„°
     * @throws NewBusinessException ë¹„ì¦ˆë‹ˆìŠ¤ ì˜ˆì™¸
     */
    @Override
    public NewKBData execute(NewKBData reqData) throws NewBusinessException {
        logger.info("=== AS{ëª¨ë“ˆ}{ê¸°ëŠ¥ë²ˆí˜¸}.execute START ===", "AS{ëª¨ë“ˆ}{ê¸°ëŠ¥ë²ˆí˜¸}");
        
        try {
            // 1. ì…ë ¥ ë°ì´í„° ê²€ì¦
            validateInputData(reqData);
            
            // 2. ëª…ë ¹ì–´ ì¶”ì¶œ
            String command = extractCommand(reqData);
            
            // 3. ëª…ë ¹ì–´ë³„ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì‹¤í–‰
            NewKBData result = processCommand(command, reqData);
            
            logger.info("=== AS{ëª¨ë“ˆ}{ê¸°ëŠ¥ë²ˆí˜¸}.execute END ===", "AS{ëª¨ë“ˆ}{ê¸°ëŠ¥ë²ˆí˜¸}");
            return result;
            
        } catch (Exception e) {
            logger.error("=== AS{ëª¨ë“ˆ}{ê¸°ëŠ¥ë²ˆí˜¸}.execute - Error: {} ===", e.getMessage(), "AS{ëª¨ë“ˆ}{ê¸°ëŠ¥ë²ˆí˜¸}");
            throw new NewBusinessException("ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì‹¤í–‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì›ì¸: " + e.getMessage());
        }
    }
    
    /**
     * ëª…ë ¹ì–´ë³„ ì²˜ë¦¬ ë¶„ê¸°
     */
    private NewKBData processCommand(String command, NewKBData reqData) 
        throws NewBusinessException {
        
        switch (command.toUpperCase()) {
            case "CREATE":
                return processCreate(reqData);
            case "READ":
                return processRead(reqData);
            case "UPDATE":
                return processUpdate(reqData);
            case "DELETE":
                return processDelete(reqData);
            case "LIST":
                return processList(reqData);
            default:
                throw new NewBusinessException("ì§€ì›í•˜ì§€ ì•ŠëŠ” ëª…ë ¹ì–´ì…ë‹ˆë‹¤: " + command);
        }
    }
}
```

#### **2. ì˜ì¡´ì„± ì£¼ì… íŒ¨í„´**

**âœ… ì˜¬ë°”ë¥¸ ì˜ì¡´ì„± ì£¼ì…**
```java
@Service
@Transactional
public class AS{ëª¨ë“ˆ}{ê¸°ëŠ¥ë²ˆí˜¸} implements NewIApplicationService {
    
    // 1. ë¡œê±° ì˜ì¡´ì„±
    private static final NewIKesaLogger logger = NewKesaLogHelper.getBiz();
    
    // 2. PC ë ˆì´ì–´ ì˜ì¡´ì„± (Presentation Control)
    @Autowired
    private PC{ë„ë©”ì¸} pc{ë„ë©”ì¸};
    
    // 3. DC ë ˆì´ì–´ ì˜ì¡´ì„± (Data Control)
    @Autowired
    private DC{ë„ë©”ì¸} dc{ë„ë©”ì¸};
    
    // 4. ìœ í‹¸ë¦¬í‹° ì˜ì¡´ì„±
    @Autowired
    private ValidationUtil validationUtil;
    
    // 5. ì™¸ë¶€ ì„œë¹„ìŠ¤ ì˜ì¡´ì„±
    @Autowired
    private ExternalService externalService;
    
    // 6. ì„¤ì • ì˜ì¡´ì„±
    @Value("${app.feature.enabled:false}")
    private boolean featureEnabled;
}
```

#### **3. íŠ¸ëœì­ì…˜ ê´€ë¦¬**

**âœ… íŠ¸ëœì­ì…˜ ì–´ë…¸í…Œì´ì…˜ ì‚¬ìš©**
```java
@Service
@Transactional
public class AS{ëª¨ë“ˆ}{ê¸°ëŠ¥ë²ˆí˜¸} implements NewIApplicationService {
    
    /**
     * ì½ê¸° ì „ìš© íŠ¸ëœì­ì…˜
     */
    @Transactional(readOnly = true)
    public NewKBData processRead(NewKBData reqData) throws NewBusinessException {
        // ì½ê¸° ì „ìš© ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
        return pc{ë„ë©”ì¸}.read(reqData);
    }
    
    /**
     * ì“°ê¸° íŠ¸ëœì­ì…˜
     */
    @Transactional
    public NewKBData processCreate(NewKBData reqData) throws NewBusinessException {
        // ì“°ê¸° ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
        return pc{ë„ë©”ì¸}.create(reqData);
    }
    
    /**
     * ë³µì¡í•œ íŠ¸ëœì­ì…˜
     */
    @Transactional(rollbackFor = {NewBusinessException.class, Exception.class})
    public NewKBData processComplexBusiness(NewKBData reqData) throws NewBusinessException {
        try {
            // 1. ë°ì´í„° ê²€ì¦
            validateData(reqData);
            
            // 2. ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì‹¤í–‰
            NewKBData result = executeBusinessLogic(reqData);
            
            // 3. ê²°ê³¼ ê²€ì¦
            validateResult(result);
            
            return result;
            
        } catch (Exception e) {
            logger.error("ë³µì¡í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì‹¤í–‰ ì‹¤íŒ¨: {}", e.getMessage());
            throw new NewBusinessException("ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì‹¤í–‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
        }
    }
}
```

#### **4. EPlaton Framework í†µí•©**

**âœ… EPlaton BizAction êµ¬ì¡°**
```java
/**
 * EPlaton ë¹„ì¦ˆë‹ˆìŠ¤ ì•¡ì…˜ êµ¬í˜„
 */
@Component
public abstract class EPlatonBizAction {
    
    private static final Logger logger = LoggerFactory.getLogger(EPlatonBizAction.class);
    
    @Autowired
    protected TCF tcf;
    
    /**
     * íŠ¸ëœì­ì…˜ ì œì–´ì™€ í•¨ê»˜ ë¹„ì¦ˆë‹ˆìŠ¤ ì•¡ì…˜ ì‹¤í–‰
     */
    public EPlatonEvent execute(EPlatonEvent event) {
        String transactionId = generateTransactionId();
        
        try {
            logger.info("ë¹„ì¦ˆë‹ˆìŠ¤ ì•¡ì…˜ ì‹œì‘: {} - íŠ¸ëœì­ì…˜: {}", 
                getClass().getSimpleName(), transactionId);
            
            // 1. ì‚¬ì „ ì²˜ë¦¬
            preAct(event);
            
            // 2. ë©”ì¸ ì•¡ì…˜ ì‹¤í–‰
            EPlatonEvent result = act(event);
            
            // 3. ì‚¬í›„ ì²˜ë¦¬
            postAct(result);
            
            logger.info("ë¹„ì¦ˆë‹ˆìŠ¤ ì•¡ì…˜ ì™„ë£Œ: {} - íŠ¸ëœì­ì…˜: {}", 
                getClass().getSimpleName(), transactionId);
            
            return result;
            
        } catch (Exception e) {
            logger.error("ë¹„ì¦ˆë‹ˆìŠ¤ ì•¡ì…˜ ì‹¤íŒ¨: {} - íŠ¸ëœì­ì…˜: {}", 
                getClass().getSimpleName(), transactionId, e);
            
            // ì—ëŸ¬ ì •ë³´ ì„¤ì •
            setErrorInfo(event, "EACT001", "ë¹„ì¦ˆë‹ˆìŠ¤ ì•¡ì…˜ ì‹¤í–‰ ì‹¤íŒ¨: " + e.getMessage());
            
            throw new RuntimeException("ë¹„ì¦ˆë‹ˆìŠ¤ ì•¡ì…˜ ì‹¤í–‰ ì‹¤íŒ¨", e);
        }
    }
    
    /**
     * ì‚¬ì „ ì²˜ë¦¬ í›…
     */
    protected void preAct(EPlatonEvent event) {
        logger.debug("ì‚¬ì „ ì²˜ë¦¬: {}", getClass().getSimpleName());
    }
    
    /**
     * ë©”ì¸ ì•¡ì…˜ ì‹¤í–‰ - í•˜ìœ„ í´ë˜ìŠ¤ì—ì„œ êµ¬í˜„
     */
    protected abstract EPlatonEvent act(EPlatonEvent event);
    
    /**
     * ì‚¬í›„ ì²˜ë¦¬ í›…
     */
    protected void postAct(EPlatonEvent event) {
        logger.debug("ì‚¬í›„ ì²˜ë¦¬: {}", getClass().getSimpleName());
    }
    
    /**
     * ì—ëŸ¬ ì •ë³´ ì„¤ì •
     */
    protected void setErrorInfo(EPlatonEvent event, String errorCode, String errorMessage) {
        TPSVCINFODTO tpsvcinfo = event.getTPSVCINFODTO();
        String currentErrorCode = tpsvcinfo.getErrorcode();
        
        if (currentErrorCode != null && currentErrorCode.startsWith("I")) {
            tpsvcinfo.setErrorcode(errorCode);
            tpsvcinfo.setError_message(errorMessage);
        } else if (currentErrorCode != null && currentErrorCode.startsWith("E")) {
            String combinedErrorCode = errorCode + "|" + currentErrorCode;
            tpsvcinfo.setErrorcode(combinedErrorCode);
            tpsvcinfo.setError_message(errorMessage);
        } else {
            tpsvcinfo.setErrorcode(errorCode);
            tpsvcinfo.setError_message(errorMessage);
        }
    }
}
```

#### **5. ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ êµ¬í˜„ íŒ¨í„´**

**âœ… CRUD ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§**
```java
@Service
@Transactional
public class AS{ëª¨ë“ˆ}{ê¸°ëŠ¥ë²ˆí˜¸} implements NewIApplicationService {
    
    /**
     * ìƒì„± ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
     */
    private NewKBData processCreate(NewKBData reqData) throws NewBusinessException {
        logger.info("=== AS{ëª¨ë“ˆ}{ê¸°ëŠ¥ë²ˆí˜¸}.processCreate START ===", "AS{ëª¨ë“ˆ}{ê¸°ëŠ¥ë²ˆí˜¸}");
        
        try {
            // 1. ì…ë ¥ ë°ì´í„° ì¶”ì¶œ
            {ë„ë©”ì¸}PDTO {ë„ë©”ì¸}PDTO = extract{ë„ë©”ì¸}PDTO(reqData);
            
            // 2. ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ ê²€ì¦
            validateBusinessRules({ë„ë©”ì¸}PDTO);
            
            // 3. PC ë ˆì´ì–´ í˜¸ì¶œ
            NewKBData result = pc{ë„ë©”ì¸}.create({ë„ë©”ì¸}PDTO);
            
            // 4. ê²°ê³¼ ê²€ì¦
            validateResult(result);
            
            logger.info("=== AS{ëª¨ë“ˆ}{ê¸°ëŠ¥ë²ˆí˜¸}.processCreate END ===", "AS{ëª¨ë“ˆ}{ê¸°ëŠ¥ë²ˆí˜¸}");
            return result;
            
        } catch (Exception e) {
            logger.error("=== AS{ëª¨ë“ˆ}{ê¸°ëŠ¥ë²ˆí˜¸}.processCreate - Error: {} ===", e.getMessage(), "AS{ëª¨ë“ˆ}{ê¸°ëŠ¥ë²ˆí˜¸}");
            throw new NewBusinessException("ìƒì„± ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì›ì¸: " + e.getMessage());
        }
    }
    
    /**
     * ì¡°íšŒ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
     */
    @Transactional(readOnly = true)
    private NewKBData processRead(NewKBData reqData) throws NewBusinessException {
        logger.info("=== AS{ëª¨ë“ˆ}{ê¸°ëŠ¥ë²ˆí˜¸}.processRead START ===", "AS{ëª¨ë“ˆ}{ê¸°ëŠ¥ë²ˆí˜¸}");
        
        try {
            // 1. ì¡°íšŒ ì¡°ê±´ ì¶”ì¶œ
            String id = extractId(reqData);
            
            // 2. PC ë ˆì´ì–´ í˜¸ì¶œ
            NewKBData result = pc{ë„ë©”ì¸}.read(id);
            
            // 3. ê²°ê³¼ ê²€ì¦
            validateReadResult(result);
            
            logger.info("=== AS{ëª¨ë“ˆ}{ê¸°ëŠ¥ë²ˆí˜¸}.processRead END ===", "AS{ëª¨ë“ˆ}{ê¸°ëŠ¥ë²ˆí˜¸}");
            return result;
            
        } catch (Exception e) {
            logger.error("=== AS{ëª¨ë“ˆ}{ê¸°ëŠ¥ë²ˆí˜¸}.processRead - Error: {} ===", e.getMessage(), "AS{ëª¨ë“ˆ}{ê¸°ëŠ¥ë²ˆí˜¸}");
            throw new NewBusinessException("ì¡°íšŒ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì›ì¸: " + e.getMessage());
        }
    }
    
    /**
     * ìˆ˜ì • ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
     */
    private NewKBData processUpdate(NewKBData reqData) throws NewBusinessException {
        logger.info("=== AS{ëª¨ë“ˆ}{ê¸°ëŠ¥ë²ˆí˜¸}.processUpdate START ===", "AS{ëª¨ë“ˆ}{ê¸°ëŠ¥ë²ˆí˜¸}");
        
        try {
            // 1. ì…ë ¥ ë°ì´í„° ì¶”ì¶œ
            {ë„ë©”ì¸}PDTO {ë„ë©”ì¸}PDTO = extract{ë„ë©”ì¸}PDTO(reqData);
            
            // 2. ê¸°ì¡´ ë°ì´í„° ì¡´ì¬ í™•ì¸
            validateExistingData({ë„ë©”ì¸}PDTO);
            
            // 3. ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ ê²€ì¦
            validateUpdateRules({ë„ë©”ì¸}PDTO);
            
            // 4. PC ë ˆì´ì–´ í˜¸ì¶œ
            NewKBData result = pc{ë„ë©”ì¸}.update({ë„ë©”ì¸}PDTO);
            
            logger.info("=== AS{ëª¨ë“ˆ}{ê¸°ëŠ¥ë²ˆí˜¸}.processUpdate END ===", "AS{ëª¨ë“ˆ}{ê¸°ëŠ¥ë²ˆí˜¸}");
            return result;
            
        } catch (Exception e) {
            logger.error("=== AS{ëª¨ë“ˆ}{ê¸°ëŠ¥ë²ˆí˜¸}.processUpdate - Error: {} ===", e.getMessage(), "AS{ëª¨ë“ˆ}{ê¸°ëŠ¥ë²ˆí˜¸}");
            throw new NewBusinessException("ìˆ˜ì • ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì›ì¸: " + e.getMessage());
        }
    }
    
    /**
     * ì‚­ì œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
     */
    private NewKBData processDelete(NewKBData reqData) throws NewBusinessException {
        logger.info("=== AS{ëª¨ë“ˆ}{ê¸°ëŠ¥ë²ˆí˜¸}.processDelete START ===", "AS{ëª¨ë“ˆ}{ê¸°ëŠ¥ë²ˆí˜¸}");
        
        try {
            // 1. ì‚­ì œ ì¡°ê±´ ì¶”ì¶œ
            String id = extractId(reqData);
            
            // 2. ì‚­ì œ ê°€ëŠ¥ì„± ê²€ì¦
            validateDeletePossibility(id);
            
            // 3. PC ë ˆì´ì–´ í˜¸ì¶œ
            NewKBData result = pc{ë„ë©”ì¸}.delete(id);
            
            logger.info("=== AS{ëª¨ë“ˆ}{ê¸°ëŠ¥ë²ˆí˜¸}.processDelete END ===", "AS{ëª¨ë“ˆ}{ê¸°ëŠ¥ë²ˆí˜¸}");
            return result;
            
        } catch (Exception e) {
            logger.error("=== AS{ëª¨ë“ˆ}{ê¸°ëŠ¥ë²ˆí˜¸}.processDelete - Error: {} ===", e.getMessage(), "AS{ëª¨ë“ˆ}{ê¸°ëŠ¥ë²ˆí˜¸}");
            throw new NewBusinessException("ì‚­ì œ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì›ì¸: " + e.getMessage());
        }
    }
    
    /**
     * ëª©ë¡ ì¡°íšŒ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
     */
    @Transactional(readOnly = true)
    private NewKBData processList(NewKBData reqData) throws NewBusinessException {
        logger.info("=== AS{ëª¨ë“ˆ}{ê¸°ëŠ¥ë²ˆí˜¸}.processList START ===", "AS{ëª¨ë“ˆ}{ê¸°ëŠ¥ë²ˆí˜¸}");
        
        try {
            // 1. ì¡°íšŒ ì¡°ê±´ ì¶”ì¶œ
            Map<String, Object> searchConditions = extractSearchConditions(reqData);
            
            // 2. PC ë ˆì´ì–´ í˜¸ì¶œ
            NewKBData result = pc{ë„ë©”ì¸}.list(searchConditions);
            
            logger.info("=== AS{ëª¨ë“ˆ}{ê¸°ëŠ¥ë²ˆí˜¸}.processList END ===", "AS{ëª¨ë“ˆ}{ê¸°ëŠ¥ë²ˆí˜¸}");
            return result;
            
        } catch (Exception e) {
            logger.error("=== AS{ëª¨ë“ˆ}{ê¸°ëŠ¥ë²ˆí˜¸}.processList - Error: {} ===", e.getMessage(), "AS{ëª¨ë“ˆ}{ê¸°ëŠ¥ë²ˆí˜¸}");
            throw new NewBusinessException("ëª©ë¡ ì¡°íšŒ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì›ì¸: " + e.getMessage());
        }
    }
}
```

### **ğŸš« NEVER DO - ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ìœ„ë°˜ì‚¬í•­**

#### **1. ì˜ëª»ëœ ì˜ì¡´ì„± ì£¼ì…**
```java
// âŒ ì˜ëª»ëœ ì˜ˆì‹œ
@Service
public class AccountService {
    
    // ì§ì ‘ Repository ì˜ì¡´ (AS ë ˆì´ì–´ì—ì„œ DC ë ˆì´ì–´ ì§ì ‘ ì˜ì¡´)
    @Autowired
    private AccountRepository accountRepository;
    
    // ì§ì ‘ Entity ì‚¬ìš©
    public Account createAccount(Account account) {
        return accountRepository.save(account);
    }
}

// âœ… ì˜¬ë°”ë¥¸ ì˜ˆì‹œ
@Service
@Transactional
public class ASMBC74001 implements NewIApplicationService {
    
    // PC ë ˆì´ì–´ë§Œ ì˜ì¡´
    @Autowired
    private PCAccount pcAccount;
    
    public NewKBData execute(NewKBData reqData) throws NewBusinessException {
        return pcAccount.create(reqData);
    }
}
```

#### **2. ì˜ëª»ëœ íŠ¸ëœì­ì…˜ ê´€ë¦¬**
```java
// âŒ ì˜ëª»ëœ ì˜ˆì‹œ
@Service
public class AccountService {
    
    public void createAccount(Account account) {
        // íŠ¸ëœì­ì…˜ ì–´ë…¸í…Œì´ì…˜ ì—†ìŒ
        accountRepository.save(account);
        // ì˜¤ë¥˜ ë°œìƒ ì‹œ ë¡¤ë°±ë˜ì§€ ì•ŠìŒ
    }
}

// âœ… ì˜¬ë°”ë¥¸ ì˜ˆì‹œ
@Service
@Transactional
public class ASMBC74001 implements NewIApplicationService {
    
    @Transactional(rollbackFor = {NewBusinessException.class})
    public NewKBData execute(NewKBData reqData) throws NewBusinessException {
        try {
            // ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
            return pcAccount.create(reqData);
        } catch (Exception e) {
            // ìë™ ë¡¤ë°±
            throw new NewBusinessException("ì²˜ë¦¬ ì‹¤íŒ¨: " + e.getMessage());
        }
    }
}
```

#### **3. ì˜ëª»ëœ ë¡œê¹…**
```java
// âŒ ì˜ëª»ëœ ì˜ˆì‹œ
@Service
public class AccountService {
    
    public void createAccount(Account account) {
        // ë¡œê¹… ì—†ìŒ
        accountRepository.save(account);
    }
}

// âœ… ì˜¬ë°”ë¥¸ ì˜ˆì‹œ
@Service
@Transactional
public class ASMBC74001 implements NewIApplicationService {
    
    private static final NewIKesaLogger logger = NewKesaLogHelper.getBiz();
    
    public NewKBData execute(NewKBData reqData) throws NewBusinessException {
        logger.info("=== ASMBC74001.execute START ===", "ASMBC74001");
        
        try {
            NewKBData result = pcAccount.create(reqData);
            logger.info("=== ASMBC74001.execute END ===", "ASMBC74001");
            return result;
        } catch (Exception e) {
            logger.error("=== ASMBC74001.execute - Error: {} ===", e.getMessage(), "ASMBC74001");
            throw new NewBusinessException("ì²˜ë¦¬ ì‹¤íŒ¨: " + e.getMessage());
        }
    }
}
```

### **ğŸ“‹ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ êµ¬í˜„ ì²´í¬ë¦¬ìŠ¤íŠ¸**

#### **ìƒˆë¡œìš´ AS í´ë˜ìŠ¤ ìƒì„± ì‹œ**
- [ ] `@Service` ì–´ë…¸í…Œì´ì…˜ ì‚¬ìš©
- [ ] `@Transactional` ì–´ë…¸í…Œì´ì…˜ ì‚¬ìš©
- [ ] `NewIApplicationService` ì¸í„°í˜ì´ìŠ¤ êµ¬í˜„
- [ ] ë¡œê±° ì„¤ì • (`NewIKesaLogger`)
- [ ] PC ë ˆì´ì–´ ì˜ì¡´ì„± ì£¼ì…
- [ ] `execute` ë©”ì„œë“œ êµ¬í˜„

#### **ì˜ì¡´ì„± ì£¼ì… ê·œì¹™**
- [ ] AS â†’ PC â†’ DC ìˆœì„œë§Œ í—ˆìš©
- [ ] `@Autowired` ì‚¬ìš©
- [ ] ìƒì„±ì ì£¼ì… ê³ ë ¤ (í•„ìš”ì‹œ)
- [ ] ìˆœí™˜ ì˜ì¡´ì„± ë°©ì§€

#### **íŠ¸ëœì­ì…˜ ê´€ë¦¬**
- [ ] ì½ê¸° ì „ìš©: `@Transactional(readOnly = true)`
- [ ] ì“°ê¸° ì‘ì—…: `@Transactional`
- [ ] ì˜ˆì™¸ ì²˜ë¦¬: `@Transactional(rollbackFor = Exception.class)`
- [ ] íŠ¸ëœì­ì…˜ ê²½ê³„ ëª…í™•íˆ ì„¤ì •

#### **ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ êµ¬í˜„**
- [ ] ì…ë ¥ ë°ì´í„° ê²€ì¦
- [ ] ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ ê²€ì¦
- [ ] PC ë ˆì´ì–´ í˜¸ì¶œ
- [ ] ê²°ê³¼ ê²€ì¦
- [ ] ì—ëŸ¬ ì²˜ë¦¬ ë° ë¡œê¹…

#### **ë¡œê¹… êµ¬í˜„**
- [ ] ë©”ì„œë“œ ì‹œì‘/ì¢…ë£Œ ë¡œê¹…
- [ ] ì…ë ¥ íŒŒë¼ë¯¸í„° ë¡œê¹…
- [ ] ì˜¤ë¥˜ ë°œìƒ ì‹œ ìƒì„¸ ë¡œê¹…
- [ ] ì„±ê³µ/ì‹¤íŒ¨ ê²°ê³¼ ë¡œê¹…

### **ğŸ”§ íŠ¹ë³„í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ íŒ¨í„´**

#### **1. ë³µí•© ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§**
```java
@Service
@Transactional
public class ASComplexBusiness implements NewIApplicationService {
    
    @Autowired
    private PCAccount pcAccount;
    
    @Autowired
    private PCUser pcUser;
    
    /**
     * ë³µí•© ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ - ê³„ì • ìƒì„±ê³¼ ì‚¬ìš©ì ì—°ë™
     */
    @Transactional(rollbackFor = {NewBusinessException.class})
    public NewKBData executeComplexBusiness(NewKBData reqData) throws NewBusinessException {
        try {
            // 1. ê³„ì • ìƒì„±
            NewKBData accountResult = pcAccount.create(reqData);
            
            // 2. ì‚¬ìš©ì ì •ë³´ ì—…ë°ì´íŠ¸
            NewKBData userResult = pcUser.update(reqData);
            
            // 3. ê²°ê³¼ í†µí•©
            return combineResults(accountResult, userResult);
            
        } catch (Exception e) {
            logger.error("ë³µí•© ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì‹¤íŒ¨: {}", e.getMessage());
            throw new NewBusinessException("ë³µí•© ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ì‹¤í–‰ ì‹¤íŒ¨");
        }
    }
}
```

#### **2. ë°°ì¹˜ ì²˜ë¦¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§**
```java
@Service
@Transactional
public class ASBatchProcessing implements NewIApplicationService {
    
    /**
     * ë°°ì¹˜ ì²˜ë¦¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
     */
    @Transactional(rollbackFor = {NewBusinessException.class})
    public NewKBData executeBatchProcessing(NewKBData reqData) throws NewBusinessException {
        List<{ë„ë©”ì¸}PDTO> {ë„ë©”ì¸}List = extract{ë„ë©”ì¸}List(reqData);
        
        for ({ë„ë©”ì¸}PDTO {ë„ë©”ì¸} : {ë„ë©”ì¸}List) {
            try {
                // ê°œë³„ ì²˜ë¦¬
                processIndividual{ë„ë©”ì¸}({ë„ë©”ì¸});
            } catch (Exception e) {
                logger.error("ë°°ì¹˜ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜: {}", e.getMessage());
                // ê°œë³„ ì‹¤íŒ¨ëŠ” ë¡œê·¸ë§Œ ë‚¨ê¸°ê³  ê³„ì† ì§„í–‰
            }
        }
        
        return createBatchResult({ë„ë©”ì¸}List);
    }
}
```

#### **3. ì¡°ê±´ë¶€ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§**
```java
@Service
@Transactional
public class ASConditionalBusiness implements NewIApplicationService {
    
    @Value("${feature.enabled:false}")
    private boolean featureEnabled;
    
    /**
     * ì¡°ê±´ë¶€ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
     */
    public NewKBData executeConditionalBusiness(NewKBData reqData) throws NewBusinessException {
        if (featureEnabled) {
            return executeNewBusinessLogic(reqData);
        } else {
            return executeLegacyBusinessLogic(reqData);
        }
    }
}
```

### **ğŸ“ EPlaton Framework í†µí•© ê°€ì´ë“œ**

#### **TCF (Transaction Control Framework) ì‚¬ìš©**
```java
@Component
public class TCF {
    
    private static final Logger logger = LoggerFactory.getLogger(TCF.class);
    
    /**
     * íŠ¸ëœì­ì…˜ ì‹¤í–‰
     */
    public Object execute(String transactionId, String transactionType, EPlatonEvent event) {
        try {
            logger.info("íŠ¸ëœì­ì…˜ ì‹¤í–‰: {} - íƒ€ì…: {}", transactionId, transactionType);
            
            // 1. íŠ¸ëœì­ì…˜ ê²€ì¦
            if (!validateTransaction(event)) {
                throw new RuntimeException("íŠ¸ëœì­ì…˜ ê²€ì¦ ì‹¤íŒ¨");
            }
            
            // 2. íŠ¸ëœì­ì…˜ ì²˜ë¦¬
            String result = processTransaction(transactionId);
            
            // 3. íŠ¸ëœì­ì…˜ ì»¤ë°‹
            if (!commitTransaction(event)) {
                throw new RuntimeException("íŠ¸ëœì­ì…˜ ì»¤ë°‹ ì‹¤íŒ¨");
            }
            
            logger.info("íŠ¸ëœì­ì…˜ ì‹¤í–‰ ì„±ê³µ: {}", transactionId);
            return result;
            
        } catch (Exception e) {
            logger.error("íŠ¸ëœì­ì…˜ ì‹¤í–‰ ì˜¤ë¥˜: {}", transactionId, e);
            
            // íŠ¸ëœì­ì…˜ ë¡¤ë°±
            rollbackTransaction(event);
            
            throw new RuntimeException("íŠ¸ëœì­ì…˜ ì‹¤í–‰ ì‹¤íŒ¨", e);
        }
    }
}
```

### **âš ï¸ ì£¼ì˜ì‚¬í•­**

1. **ë ˆì´ì–´ ê°„ ì˜ì¡´ì„±**: AS â†’ PC â†’ DC ìˆœì„œë§Œ í—ˆìš©
2. **íŠ¸ëœì­ì…˜ ê²½ê³„**: ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ë‹¨ìœ„ë¡œ íŠ¸ëœì­ì…˜ ì„¤ì •
3. **ì˜ˆì™¸ ì²˜ë¦¬**: ëª¨ë“  ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì—ì„œ ì ì ˆí•œ ì˜ˆì™¸ ì²˜ë¦¬
4. **ë¡œê¹…**: ëª¨ë“  ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì—ì„œ ìƒì„¸í•œ ë¡œê¹…
5. **ê²€ì¦**: ì…ë ¥ ë°ì´í„°ì™€ ë¹„ì¦ˆë‹ˆìŠ¤ ê·œì¹™ ê²€ì¦ í•„ìˆ˜
6. **ì„±ëŠ¥**: ì½ê¸° ì „ìš© íŠ¸ëœì­ì…˜ ì ì ˆíˆ ì‚¬ìš©

ì´ ê°€ì´ë“œë¥¼ ë”°ë¼ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì„ êµ¬í˜„í•˜ë©´ ì¼ê´€ì„± ìˆê³  ìœ ì§€ë³´ìˆ˜í•˜ê¸° ì‰¬ìš´ ë°±ì—”ë“œ ì„œë¹„ìŠ¤ë¥¼ êµ¬ì¶•í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
description:
globs:
alwaysApply: false
---
