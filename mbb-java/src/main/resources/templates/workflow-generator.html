<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${title}">전체 워크플로우 생성 - MBB Java</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .form-section { background: #f8f9fa; padding: 2rem; border-radius: 10px; margin-bottom: 2rem; }
        .preview-section { background: #fff; padding: 2rem; border-radius: 10px; border: 1px solid #dee2e6; }
        .code-preview { background: #f8f9fa; border: 1px solid #dee2e6; border-radius: 5px; padding: 1rem; }
        .workflow-step { background: #fff; padding: 1rem; border-radius: 5px; margin-bottom: 1rem; border-left: 4px solid #007bff; }
        .workflow-step.completed { border-left-color: #28a745; }
        .workflow-step.error { border-left-color: #dc3545; }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="/mbb/">MBB Java</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="/mbb/">홈</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/mbb/workflow-generator">전체 워크플로우</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/mbb/api-test">API 테스트</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <div>
                <h1 class="mb-2">전체 워크플로우 생성</h1>
                <p class="lead mb-0">모든 단계를 한 번에 실행하는 통합 워크플로우입니다.</p>
            </div>
            <a href="/mbb/" class="btn btn-outline-primary">
                <i class="fas fa-home"></i> 홈으로
            </a>
        </div>

        <!-- Workflow Generation Form -->
        <div class="form-section">
            <h3 class="mb-3">워크플로우 설정</h3>
            
            <div class="row mb-3">
                <div class="col-md-6">
                    <label for="entityName" class="form-label">Entity 클래스명</label>
                    <input type="text" class="form-control" id="entityName" placeholder="예: Mbbuser, Product, Order">
                </div>
                <div class="col-md-6">
                    <label for="tableName" class="form-label">테이블명</label>
                    <input type="text" class="form-control" id="tableName" placeholder="예: users, products, orders">
                </div>
            </div>

            <div class="row mb-3">
                <div class="col-md-6">
                    <label for="packageName" class="form-label">기본 패키지명</label>
                    <input type="text" class="form-control" id="packageName" placeholder="예: com.example">
                </div>
                <div class="col-md-6">
                    <label for="databaseType" class="form-label">데이터베이스 타입</label>
                    <select class="form-select" id="databaseType">
                        <option value="mysql">MySQL</option>
                        <option value="postgresql">PostgreSQL</option>
                        <option value="h2">H2</option>
                    </select>
                </div>
            </div>

            <div class="mb-3">
                <label class="form-label">생성할 컴포넌트</label>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="generateEntity" checked>
                    <label class="form-check-label" for="generateEntity">
                        Entity 클래스
                    </label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="generateRepository" checked>
                    <label class="form-check-label" for="generateRepository">
                        Repository 인터페이스
                    </label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="generateService" checked>
                    <label class="form-check-label" for="generateService">
                        Service 클래스
                    </label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="generateController" checked>
                    <label class="form-check-label" for="generateController">
                        Controller 클래스
                    </label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="generateDto" checked>
                    <label class="form-check-label" for="generateDto">
                        DTO 클래스들
                    </label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="generateTemplate" checked>
                    <label class="form-check-label" for="generateTemplate">
                        HTML 템플릿
                    </label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="generateDdl" checked>
                    <label class="form-check-label" for="generateDdl">
                        DDL 스크립트
                    </label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="generateData" checked>
                    <label class="form-check-label" for="generateData">
                        초기 데이터
                    </label>
                </div>
            </div>

            <button type="button" class="btn btn-primary" onclick="generateWorkflow()">
                <i class="fas fa-rocket"></i> 전체 워크플로우 실행
            </button>
        </div>

        <!-- Workflow Progress -->
        <div class="preview-section">
            <h3 class="mb-3">워크플로우 진행 상황</h3>
            <div id="workflowProgress">
                <div class="workflow-step" id="step1">
                    <h5><i class="fas fa-table"></i> 1. 테이블 정의서 입력</h5>
                    <p class="mb-0">테이블 구조 정의</p>
                </div>
                <div class="workflow-step" id="step2">
                    <h5><i class="fas fa-code"></i> 2. Entity 자동 생성</h5>
                    <p class="mb-0">JPA Entity 클래스 생성</p>
                </div>
                <div class="workflow-step" id="step3">
                    <h5><i class="fas fa-database"></i> 3. Repository 자동 생성</h5>
                    <p class="mb-0">Spring Data JPA Repository 생성</p>
                </div>
                <div class="workflow-step" id="step4">
                    <h5><i class="fas fa-cogs"></i> 4. Service 자동 생성</h5>
                    <p class="mb-0">비즈니스 로직 Service 생성</p>
                </div>
                <div class="workflow-step" id="step5">
                    <h5><i class="fas fa-globe"></i> 5. Controller 자동 생성</h5>
                    <p class="mb-0">REST API Controller 생성</p>
                </div>
                <div class="workflow-step" id="step6">
                    <h5><i class="fas fa-file-alt"></i> 6. DTO & Validator 생성</h5>
                    <p class="mb-0">Request/Response DTO 생성</p>
                </div>
                <div class="workflow-step" id="step7">
                    <h5><i class="fas fa-book"></i> 7. Swagger 자동 문서화</h5>
                    <p class="mb-0">API 문서 자동 생성</p>
                </div>
                <div class="workflow-step" id="step8">
                    <h5><i class="fas fa-file-code"></i> 8. HTML 템플릿 생성</h5>
                    <p class="mb-0">Thymeleaf 템플릿 생성</p>
                </div>
                <div class="workflow-step" id="step9">
                    <h5><i class="fas fa-database"></i> 9. DDL 자동 Export</h5>
                    <p class="mb-0">데이터베이스 DDL 생성</p>
                </div>
                <div class="workflow-step" id="step10">
                    <h5><i class="fas fa-download"></i> 10. 초기 데이터 생성</h5>
                    <p class="mb-0">초기 데이터 스크립트 생성</p>
                </div>
            </div>
            <div class="mt-3">
                <button type="button" class="btn btn-success" onclick="downloadAllFiles()">
                    <i class="fas fa-download"></i> 모든 파일 다운로드
                </button>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        function generateWorkflow() {
            const entityName = document.getElementById('entityName').value;
            const tableName = document.getElementById('tableName').value;
            const packageName = document.getElementById('packageName').value;
            const databaseType = document.getElementById('databaseType').value;

            if (!entityName || !tableName || !packageName) {
                alert('모든 필수 필드를 입력해주세요.');
                return;
            }

            // 워크플로우 단계별 실행 시뮬레이션
            simulateWorkflow();
        }

        function simulateWorkflow() {
            const steps = document.querySelectorAll('.workflow-step');
            
            steps.forEach((step, index) => {
                setTimeout(() => {
                    step.classList.add('completed');
                    step.querySelector('h5').innerHTML += ' <i class="fas fa-check text-success"></i>';
                    
                    if (index === steps.length - 1) {
                        setTimeout(() => {
                            alert('워크플로우가 완료되었습니다!');
                        }, 500);
                    }
                }, (index + 1) * 1000);
            });
        }

        function downloadAllFiles() {
            alert('모든 생성된 파일들이 다운로드됩니다.');
            // 실제 구현에서는 모든 파일을 ZIP으로 압축하여 다운로드
        }
    </script>
</body>
</html> 